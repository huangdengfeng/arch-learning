import{_ as i,M as l,p as t,q as r,a1 as a,R as d,t as s,N as c}from"./framework-a44ba987.js";const o={},u={href:"https://dev.mysql.com/doc/refman/5.7/en/mysqldump.html",target:"_blank",rel:"noopener noreferrer"};function m(v,e){const n=l("ExternalLinkIcon");return t(),r("div",null,[e[2]||(e[2]=a(`<h1 id="mysql-常用命令" tabindex="-1"><a class="header-anchor" href="#mysql-常用命令" aria-hidden="true">#</a> mysql 常用命令</h1><h2 id="导出常用命令" tabindex="-1"><a class="header-anchor" href="#导出常用命令" aria-hidden="true">#</a> 导出常用命令</h2><p>下列方式述自带库名语句:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/usr/local/mysql/bin/mysqldump  -u用户名 -p密码 [--default-character-set=utf8mb4] --all-databases &gt; /保存路径/文件名.sql

/usr/local/mysql/bin/mysqldump -u用户名 -p密码 --databases 数据库1 数据库2... &gt; 保存路径/文件名.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>指定单库备份默认不自带库名语句:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/usr/local/mysql/bin/mysqldump -u用户名 -p密码 [-B] db &gt; /保存路径/文件名.sql  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>-B 可以带建库语句</p><p>-t 主要数据</p><p>-d 只要结构</p><h2 id="导入常用命令" tabindex="-1"><a class="header-anchor" href="#导入常用命令" aria-hidden="true">#</a> 导入常用命令</h2><p>导入如果带库名则不需要指定DB</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mysql -uusername -ppassword [db1] &lt; tb1tb2.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,12)),d("p",null,[e[1]||(e[1]=s("更多参数")),d("a",u,[e[0]||(e[0]=s("https://dev.mysql.com/doc/refman/5.7/en/mysqldump.html")),c(n)])]),e[3]||(e[3]=a(`<h2 id="binlog-查看sql" tabindex="-1"><a class="header-anchor" href="#binlog-查看sql" aria-hidden="true">#</a> binlog 查看sql</h2><p>通过binlog 看sql /usr/local/zftmysql/bin/mysqlbinlog --base64-output=decode-rows -v --start-datetime=&#39;2022-04-25 20:00:00&#39; --stop-datetime=&#39;2022-04-25 21:30:00&#39; binlog/binlog.000038</p><h2 id="备份" tabindex="-1"><a class="header-anchor" href="#备份" aria-hidden="true">#</a> 备份</h2><p>添加定时任务<code>crontab -e</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>* 8 * * * /data/db_backup/cron_backup.sh &gt;/dev/null  2&gt;&amp;1 &amp;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>脚本<code>cron_backup.sh</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>#!/bin/bash
cd \`dirname $0\`
pwd
mkdir sqls 2&gt;/dev/null
echo &quot;clear sql files before one week ago.&quot;
find ./sqls/ -name &quot;*.sql&quot;  -ctime +30  -exec rm -rf 2&gt;/dev/null {}  \\;
echo &quot;dump today&#39;s db .&quot;

# --skip-extended-insert fobid multivalue insert sql
# --complete-insert use total sql include col name

mysqldump --single-transaction -u\${user} -p\${password} -h \${host} -P \${port} --default-character-set=utf8mb4 --skip-extended-insert --complete-insert --ignore-table=\${ignoreTable} -B  \${database} &gt; sqls/\${database}.\`date +%Y%m%d\`.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="用户及授权" tabindex="-1"><a class="header-anchor" href="#用户及授权" aria-hidden="true">#</a> 用户及授权</h2><h3 id="创建用户" tabindex="-1"><a class="header-anchor" href="#创建用户" aria-hidden="true">#</a> 创建用户</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>CREATE USER &#39;finley&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;password&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="修改密码" tabindex="-1"><a class="header-anchor" href="#修改密码" aria-hidden="true">#</a> 修改密码</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ALTER USER &#39;jeffrey&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;new_password&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="删除用户" tabindex="-1"><a class="header-anchor" href="#删除用户" aria-hidden="true">#</a> 删除用户</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>DROP USER &#39;finley&#39;@&#39;localhost&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="授权" tabindex="-1"><a class="header-anchor" href="#授权" aria-hidden="true">#</a> 授权</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>GRANT ALL ON *.* TO &#39;finley&#39;@&#39;localhost&#39; WITH GRANT OPTION;
FLUSH PRIVILEGES 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>详细见(https://dev.mysql.com/doc/refman/8.0/en/creating-accounts.html)[https://dev.mysql.com/doc/refman/8.0/en/creating-accounts.html]</p>`,17))])}const b=i(o,[["render",m],["__file","mysql.html.vue"]]);export{b as default};
